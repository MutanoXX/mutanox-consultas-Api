<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîí Teste de Seguran√ßa - MutanoX Dashboard</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #0d1117;
            color: #c9d1d9;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #1f6feb 0%, #58a6ff 100%);
            border-radius: 8px;
            color: white;
        }
        .test-section {
            background: #161b22;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #238636;
        }
        .test-section.warning { border-left-color: #d29922; }
        .test-section.danger { border-left-color: #da3633; }
        .success { color: #238636; }
        .error { color: #da3633; }
        .warning { color: #d29922; }
        .info { color: #58a6ff; }
        pre {
            background: #0d1117;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            border: 1px solid #30363d;
        }
        code {
            color: #ff7b72;
        }
        button {
            background: #238636;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 0;
            font-family: inherit;
            font-size: 14px;
        }
        button:hover { background: #2ea043; }
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .badge-secure { background: #238636; color: white; }
        .badge-insecure { background: #da3633; color: white; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîí TESTE DE SEGURAN√áA</h1>
        <p>MutanoX Dashboard - Valida√ß√£o via API</p>
    </div>

    <div class="test-section">
        <h2>‚úÖ TESTE 1: Credenciais no HTML</h2>
        <button onclick="testHTML()">Verificar HTML</button>
        <div id="html-result"></div>
    </div>

    <div class="test-section">
        <h2>‚úÖ TESTE 2: Credenciais no JavaScript</h2>
        <button onclick="testJS()">Verificar JavaScript</button>
        <div id="js-result"></div>
    </div>

    <div class="test-section">
        <h2>‚úÖ TESTE 3: Valida√ß√£o via API</h2>
        <input type="text" id="test-username" placeholder="Usu√°rio" style="padding: 8px; margin: 5px 0; width: 200px; background: #0d1117; border: 1px solid #30363d; color: white; border-radius: 4px;">
        <input type="password" id="test-password" placeholder="Senha" style="padding: 8px; margin: 5px 0; width: 200px; background: #0d1117; border: 1px solid #30363d; color: white; border-radius: 4px;">
        <br>
        <button onclick="testAPILogin()">Testar Login</button>
        <div id="api-result"></div>
    </div>

    <div class="test-section warning">
        <h2>‚ö†Ô∏è TESTE 4: Download do Site</h2>
        <p>Se voc√™ baixar o site e abrir localmente, o login N√ÉO vai funcionar!</p>
        <pre>Por que?
- A valida√ß√£o √© feita no SERVIDOR (API)
- N√£o h√° credenciais no c√≥digo frontend
- O endpoint /api/admin/validate s√≥ existe no servidor</pre>
    </div>

    <div class="test-section danger">
        <h2>üîì TESTE 5: Inspe√ß√£o do Elemento (F12)</h2>
        <p>Abra F12 e tente achar as credenciais:</p>
        <ul>
            <li>‚ùå N√£o est√£o no HTML</li>
            <li>‚ùå N√£o est√£o no JavaScript</li>
            <li>‚ùå N√£o est√£o em localStorage</li>
            <li>‚ùå N√£o h√° valida√ß√£o local</li>
            <li>‚úÖ S√≥ est√£o no SERVIDOR</li>
        </ul>
    </div>

    <div id="summary" style="margin-top: 30px; padding: 20px; background: #161b22; border-radius: 8px; border: 2px solid #238636;">
        <h2 style="color: #238636;">üìä RESUMO DE SEGURAN√áA</h2>
        <div id="summary-content"></div>
    </div>

    <script>
        async function testHTML() {
            const resultDiv = document.getElementById('html-result');
            resultDiv.innerHTML = '<p class="info">Buscando credenciais no HTML...</p>';

            try {
                const response = await fetch('http://localhost:8080/admin');
                const html = await response.text();

                const hasUsername = html.includes('admin') && html.includes('Usu√°rio:');
                const hasPassword = html.includes('MutanoX3397') && html.includes('Senha:');

                if (!hasUsername && !hasPassword) {
                    resultDiv.innerHTML = `
                        <p class="success">‚úÖ SEGURO!</p>
                        <p>Nenhuma credencial encontrada no HTML</p>
                        <pre>Usu√°rio n√£o aparece: <span class="success">‚úÖ</span>
Senha n√£o aparece: <span class="success">‚úÖ</span></pre>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <p class="error">‚ùå INSEGURO!</p>
                        <p>Credenciais encontradas no HTML</p>
                    `;
                }
            } catch (e) {
                resultDiv.innerHTML = `<p class="error">‚ùå Erro: ${e.message}</p>`;
            }
        }

        async function testJS() {
            const resultDiv = document.getElementById('js-result');
            resultDiv.innerHTML = '<p class="info">Buscando credenciais no JavaScript...</p>';

            try {
                const response = await fetch('http://localhost:8080/dashboards/dashboard-production.js');
                const js = await response.text();

                const hasHardcodedCreds = js.includes("username === 'admin'") && js.includes("password === 'MutanoX3397'");

                if (!hasHardcodedCreds) {
                    resultDiv.innerHTML = `
                        <p class="success">‚úÖ SEGURO!</p>
                        <p>N√£o h√° valida√ß√£o local com credenciais</p>
                        <pre>Valida√ß√£o via fetch: <span class="success">‚úÖ</span>
Endpoint: /api/admin/validate
M√©todo: POST</pre>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <p class="error">‚ùå INSEGURO!</p>
                        <p>Credenciais hardcoded no JavaScript</p>
                    `;
                }
            } catch (e) {
                resultDiv.innerHTML = `<p class="error">‚ùå Erro: ${e.message}</p>`;
            }
        }

        async function testAPILogin() {
            const resultDiv = document.getElementById('api-result');
            const username = document.getElementById('test-username').value;
            const password = document.getElementById('test-password').value;

            resultDiv.innerHTML = '<p class="info">Testando login via API...</p>';

            try {
                const response = await fetch('http://localhost:8080/api/admin/validate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();

                if (response.ok && data.success) {
                    resultDiv.innerHTML = `
                        <p class="success">‚úÖ Login bem-sucedido!</p>
                        <p>AdminKey: ${data.adminKey}</p>
                        <p>Mensagem: ${data.message}</p>
                        <pre>Status: <span class="success">200 OK</span>
Valida√ß√£o: <span class="success">SERVIDOR</span></pre>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <p class="error">‚ùå Login falhou!</p>
                        <p>Status: ${response.status}</p>
                        <p>Mensagem: ${data.message}</p>
                    `;
                }
            } catch (e) {
                resultDiv.innerHTML = `<p class="error">‚ùå Erro: ${e.message}</p>`;
            }
        }

        window.onload = function() {
            document.getElementById('summary-content').innerHTML = `
                <p><strong>Valida√ß√£o:</strong> Via API (Back-end) <span class="status-badge badge-secure">SEGURO</span></p>
                <p><strong>Credenciais no HTML:</strong> N√£o <span class="status-badge badge-secure">‚úÖ</span></p>
                <p><strong>Credenciais no JS:</strong> N√£o <span class="status-badge badge-secure">‚úÖ</span></p>
                <p><strong>Valida√ß√£o local:</strong> N√£o existe <span class="status-badge badge-secure">‚úÖ</span></p>
                <p><strong>Prote√ß√£o contra download:</strong> Sim <span class="status-badge badge-secure">‚úÖ</span></p>
                <hr style="margin: 15px 0; border: 1px solid #30363d;">
                <p class="success">üîí O sistema est√° SEGURO!</p>
                <p style="margin-top: 10px; font-size: 14px;">
                    Mesmo que algu√©m baixe o site, n√£o conseguir√° acesso √†s credenciais
                    porque a valida√ß√£o √© feita no servidor e as credenciais n√£o est√£o
                    expostas no c√≥digo frontend.
                </p>
            `;
        };
    </script>
</body>
</html>
